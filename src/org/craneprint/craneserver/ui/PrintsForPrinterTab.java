package org.craneprint.craneserver.ui;

import com.vaadin.annotations.AutoGenerated;
import com.vaadin.ui.Button;
import com.vaadin.ui.Button.ClickEvent;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.Table;
import com.vaadin.ui.UI;
import com.vaadin.ui.VerticalLayout;

public class PrintsForPrinterTab extends CustomComponent {

	@AutoGenerated
	private VerticalLayout mainLayout;
	private Table printsTable;
	private Button refreshButton;
	private int printerId;
	private Craneprint_craneserverUI ui;

	/**
	 * The constructor should first build the main layout, set the
	 * composition root and then do any custom initialization.
	 *
	 * The constructor will not be automatically regenerated by the
	 * visual editor.
	 */
	public PrintsForPrinterTab(int pid, Craneprint_craneserverUI u) {
		ui = u;
		printerId = pid;
		buildMainLayout();
		setCompositionRoot(mainLayout);

		// TODO add user code here
	}

	@AutoGenerated
	private void buildMainLayout() {
		// the main layout and components will be created here
		mainLayout = new VerticalLayout();
		mainLayout.setSizeFull();
		
		refreshButton = new Button("Refresh Table");
		refreshButton.addClickListener(new Button.ClickListener() {
		    public void buttonClick(ClickEvent event) {
		        refreshTable();
		    }
		});
		printsTable = ui.getDBManager().getPrintsForPrinter(printerId, this);
		printsTable.setSizeFull();
		mainLayout.addComponent(refreshButton);
		mainLayout.addComponent(printsTable);
	}
	
	public void refreshTable() {
		mainLayout.removeComponent(printsTable);
		printsTable = ui.getDBManager().getPrintsForPrinter(printerId, this);
		printsTable.setSizeFull();
		mainLayout.addComponent(printsTable);
	}

}